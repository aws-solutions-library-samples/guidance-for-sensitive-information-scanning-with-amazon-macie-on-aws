{
  "version": 3,
  "sources": ["../../lib/lambda/create-macie-job/index.ts", "../../lib/lambda/create-macie-job/types/macie-job-request.guard.ts", "../../lib/lambda/shared/utils/logger.ts", "../../lib/lambda/shared/utils/error-handler.ts", "../../lib/lambda/shared/utils/eventbridge-validator.ts"],
  "sourcesContent": ["import { Context, APIGatewayProxyEvent, APIGatewayProxyResult } from 'aws-lambda';\nimport { Macie2Client, CreateClassificationJobCommand, CreateClassificationJobCommandOutput } from '@aws-sdk/client-macie2';\nimport { MacieJobRequest, MacieJobResponse } from './types/macie-job-request';\nimport { isMacieJobRequest } from './types/macie-job-request.guard';\nimport { Logger } from '../shared/utils/logger';\nimport { ErrorHandler } from '../shared/utils/error-handler';\nimport { EventBridgeValidator } from '../shared/utils/eventbridge-validator';\n\n/**\n * Type guard to check if event is an API Gateway proxy event\n */\nfunction isAPIGatewayEvent(event: any): event is APIGatewayProxyEvent {\n  return event && typeof event === 'object' && 'httpMethod' in event && 'headers' in event;\n}\n\n/**\n * Create standardized API Gateway error response\n */\nfunction createAPIGatewayErrorResponse(statusCode: number, message: string, requestId: string): APIGatewayProxyResult {\n  return {\n    statusCode,\n    headers: {\n      'Content-Type': 'application/json',\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'POST, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, X-Amz-Date, Authorization, X-Api-Key, X-Amz-Security-Token'\n    },\n    body: JSON.stringify({\n      success: false,\n      error: {\n        type: 'ValidationError',\n        message,\n        requestId\n      }\n    })\n  };\n}\n\n/**\n * Create standardized API Gateway success response\n */\nfunction createAPIGatewaySuccessResponse(data: any): APIGatewayProxyResult {\n  return {\n    statusCode: 200,\n    headers: {\n      'Content-Type': 'application/json',\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'POST, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, X-Amz-Date, Authorization, X-Api-Key, X-Amz-Security-Token'\n    },\n    body: JSON.stringify(data)\n  };\n}\n\n/**\n * AWS Lambda handler for creating Amazon Macie Classification Jobs\n * \n * This function:\n * 1. Handles both direct Lambda invocation and API Gateway proxy events\n * 2. Validates the input event using ts-auto-guard generated type guards\n * 3. Creates a Macie Classification Job using the AWS SDK\n * 4. Provides detailed logging of all operations\n * 5. Returns structured success/error responses\n */\nexport const handler = async (\n  event: MacieJobRequest | APIGatewayProxyEvent,\n  context: Context\n): Promise<MacieJobResponse | APIGatewayProxyResult> => {\n  const startTime = Date.now();\n\n  // Initialize logger with context\n  const logger = new Logger({\n    requestId: context.awsRequestId,\n    functionName: context.functionName,\n    functionVersion: context.functionVersion\n  });\n\n  // Initialize error handler\n  const errorHandler = new ErrorHandler(logger, context);\n\n  logger.info('Lambda function started', {\n    functionName: context.functionName,\n    functionVersion: context.functionVersion,\n    remainingTimeInMillis: context.getRemainingTimeInMillis(),\n    eventType: isAPIGatewayEvent(event) ? 'APIGatewayProxyEvent' : 'DirectInvocation'\n  });\n\n  try {\n    // Step 1: Parse and validate input event\n    logger.info('Parsing input event');\n\n    let macieJobRequest: MacieJobRequest;\n\n    if (isAPIGatewayEvent(event)) {\n      // Handle API Gateway proxy event\n      logger.info('Processing API Gateway proxy event');\n      \n      if (!event.body) {\n        const errorMessage = 'API Gateway event missing body';\n        return createAPIGatewayErrorResponse(400, errorMessage, context.awsRequestId);\n      }\n\n      try {\n        macieJobRequest = JSON.parse(event.body);\n        logger.info('Successfully parsed API Gateway request body');\n      } catch (parseError: any) {\n        const errorMessage = 'Invalid JSON in request body';\n        logger.error('JSON parse error', parseError);\n        return createAPIGatewayErrorResponse(400, errorMessage, context.awsRequestId);\n      }\n    } else {\n      // Handle direct Lambda invocation\n      logger.info('Processing direct Lambda invocation');\n      macieJobRequest = event as MacieJobRequest;\n    }\n\n    // Step 2: Validate the parsed request\n    logger.info('Validating MacieJobRequest schema');\n\n    if (!isMacieJobRequest(macieJobRequest)) {\n      const errorMessage = 'Invalid input: Event does not match MacieJobRequest schema';\n      if (isAPIGatewayEvent(event)) {\n        return createAPIGatewayErrorResponse(400, errorMessage, context.awsRequestId);\n      }\n      return errorHandler.handleValidationError(errorMessage, macieJobRequest);\n    }\n\n    logger.info('Input validation successful', {\n      jobType: macieJobRequest.jobType,\n      jobName: macieJobRequest.name,\n      hasS3JobDefinition: !!macieJobRequest.s3JobDefinition,\n      hasBucketDefinitions: !!macieJobRequest.s3JobDefinition?.bucketDefinitions,\n      bucketDefinitionsCount: macieJobRequest.s3JobDefinition?.bucketDefinitions?.length || 0\n    });\n\n    // Step 3: Validate required EventBridge tag\n    logger.info('Validating required JobStatusEventBusArn tag');\n\n    const eventBridgeValidator = new EventBridgeValidator(logger);\n    const eventBusArn = eventBridgeValidator.findEventBusArnTag(macieJobRequest.tags);\n\n    if (!eventBusArn) {\n      const errorMessage = 'Required tag \"JobStatusEventBusArn\" is missing';\n      const providedTags = macieJobRequest.tags ? Object.keys(macieJobRequest.tags) : [];\n      const errorResponse = errorHandler.handleEventBridgeValidationError(\n        errorMessage,\n        undefined,\n        `Missing required tag. Provided tags: ${providedTags.join(', ')}`\n      );\n      \n      if (isAPIGatewayEvent(event)) {\n        return createAPIGatewayErrorResponse(400, errorMessage, context.awsRequestId);\n      }\n      return errorResponse;\n    }\n\n    logger.info('Found JobStatusEventBusArn tag', { eventBusArn });\n\n    // Validate EventBus ARN format and existence\n    const validationResult = await eventBridgeValidator.validateEventBusArn(eventBusArn);\n\n    if (!validationResult.isValid) {\n      const errorMessage = 'Invalid or non-existent EventBus ARN in JobStatusEventBusArn tag';\n      return errorHandler.handleEventBridgeValidationError(\n        errorMessage,\n        eventBusArn,\n        validationResult.error\n      );\n    }\n\n    logger.info('EventBridge validation successful', {\n      eventBusArn,\n      eventBusName: validationResult.eventBusName\n    });\n\n    // Step 3: Initialize Macie client\n    logger.info('Initializing Macie client');\n\n    const macieClient = new Macie2Client({\n      region: process.env.AWS_REGION || 'us-east-1'\n    });\n\n    // Step 4: Prepare CreateClassificationJob command\n    logger.info('Preparing CreateClassificationJob command');\n\n    const createJobCommand = new CreateClassificationJobCommand(macieJobRequest);\n\n    // Log the API request (sanitized)\n    logger.logApiRequest('Macie2', 'CreateClassificationJob', macieJobRequest);\n\n    // Step 5: Execute the Macie API call\n    logger.info('Executing CreateClassificationJob API call');\n    const apiStartTime = Date.now();\n\n    let response: CreateClassificationJobCommandOutput;\n\n    try {\n      response = await macieClient.send(createJobCommand);\n    } catch (macieError: any) {\n      const apiDuration = Date.now() - apiStartTime;\n      logger.error('Macie API call failed', macieError, {\n        apiDuration: `${apiDuration}ms`\n      });\n\n      return errorHandler.handleAwsApiError(macieError, 'Macie2', 'CreateClassificationJob');\n    }\n\n    const apiDuration = Date.now() - apiStartTime;\n\n    // Log the API response (sanitized)\n    logger.logApiResponse('Macie2', 'CreateClassificationJob', response, apiDuration);\n\n    // Step 6: Validate response\n    if (!response.jobId || !response.jobArn) {\n      const errorMessage = 'Invalid response from Macie API: Missing jobId or jobArn';\n      return errorHandler.handleCustomError('InvalidApiResponse', errorMessage, response);\n    }\n\n    // Step 7: Prepare success response\n    const successResponse: MacieJobResponse = {\n      success: true,\n      data: {\n        jobId: response.jobId,\n        jobArn: response.jobArn,\n        requestId: context.awsRequestId\n      }\n    };\n\n    logger.info('Macie Classification Job created successfully', {\n      jobId: response.jobId,\n      jobArn: response.jobArn,\n      jobName: macieJobRequest.name,\n      jobType: macieJobRequest.jobType\n    });\n\n    // Log total execution time\n    logger.logTiming('CreateMacieJob Lambda execution', startTime);\n\n    // Return appropriate response format based on invocation type\n    if (isAPIGatewayEvent(event)) {\n      return createAPIGatewaySuccessResponse(successResponse);\n    }\n    \n    return successResponse;\n\n  } catch (error: any) {\n    // Handle unexpected errors\n    return errorHandler.handleUnexpectedError(error);\n  }\n};\n", "/*\n * Generated type guards for \"macie-job-request.ts\".\n * WARNING: Do not manually change this file.\n */\nimport { MacieJobRequest, MacieJobSuccessResponse, MacieJobErrorResponse, MacieJobResponse } from \"./macie-job-request\";\n\nexport function isMacieJobRequest(obj: unknown): obj is MacieJobRequest {\n    const typedObj = obj as MacieJobRequest\n    return (\n        (typedObj !== null &&\n            typeof typedObj === \"object\" ||\n            typeof typedObj === \"function\") &&\n        (typeof typedObj[\"allowListIds\"] === \"undefined\" ||\n            Array.isArray(typedObj[\"allowListIds\"]) &&\n            typedObj[\"allowListIds\"].every((e: any) =>\n                typeof e === \"string\"\n            )) &&\n        (typeof typedObj[\"clientToken\"] === \"undefined\" ||\n            typeof typedObj[\"clientToken\"] === \"string\") &&\n        (typeof typedObj[\"customDataIdentifierIds\"] === \"undefined\" ||\n            Array.isArray(typedObj[\"customDataIdentifierIds\"]) &&\n            typedObj[\"customDataIdentifierIds\"].every((e: any) =>\n                typeof e === \"string\"\n            )) &&\n        (typeof typedObj[\"description\"] === \"undefined\" ||\n            typeof typedObj[\"description\"] === \"string\") &&\n        (typeof typedObj[\"initialRun\"] === \"undefined\" ||\n            typedObj[\"initialRun\"] === false ||\n            typedObj[\"initialRun\"] === true) &&\n        (typeof typedObj[\"jobType\"] === \"undefined\" ||\n            typedObj[\"jobType\"] === \"ONE_TIME\" ||\n            typedObj[\"jobType\"] === \"SCHEDULED\") &&\n        (typeof typedObj[\"managedDataIdentifierIds\"] === \"undefined\" ||\n            Array.isArray(typedObj[\"managedDataIdentifierIds\"]) &&\n            typedObj[\"managedDataIdentifierIds\"].every((e: any) =>\n                typeof e === \"string\"\n            )) &&\n        (typeof typedObj[\"managedDataIdentifierSelector\"] === \"undefined\" ||\n            typedObj[\"managedDataIdentifierSelector\"] === \"ALL\" ||\n            typedObj[\"managedDataIdentifierSelector\"] === \"EXCLUDE\" ||\n            typedObj[\"managedDataIdentifierSelector\"] === \"INCLUDE\" ||\n            typedObj[\"managedDataIdentifierSelector\"] === \"NONE\" ||\n            typedObj[\"managedDataIdentifierSelector\"] === \"RECOMMENDED\") &&\n        (typeof typedObj[\"name\"] === \"undefined\" ||\n            typeof typedObj[\"name\"] === \"string\") &&\n        (typeof typedObj[\"s3JobDefinition\"] === \"undefined\" ||\n            (typedObj[\"s3JobDefinition\"] !== null &&\n                typeof typedObj[\"s3JobDefinition\"] === \"object\" ||\n                typeof typedObj[\"s3JobDefinition\"] === \"function\") &&\n            (typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"] === \"undefined\" ||\n                (typedObj[\"s3JobDefinition\"][\"bucketCriteria\"] !== null &&\n                    typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"] === \"object\" ||\n                    typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"] === \"function\") &&\n                (typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"] === \"undefined\" ||\n                    (typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"] !== null &&\n                        typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"] === \"object\" ||\n                        typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"] === \"function\") &&\n                    (typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"][\"and\"] === \"undefined\" ||\n                        Array.isArray(typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"][\"and\"]) &&\n                        typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"excludes\"][\"and\"].every((e: any) =>\n                            (e !== null &&\n                                typeof e === \"object\" ||\n                                typeof e === \"function\") &&\n                            (typeof e[\"simpleCriterion\"] === \"undefined\" ||\n                                (e[\"simpleCriterion\"] !== null &&\n                                    typeof e[\"simpleCriterion\"] === \"object\" ||\n                                    typeof e[\"simpleCriterion\"] === \"function\") &&\n                                (typeof e[\"simpleCriterion\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"GT\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"LT\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"NE\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"simpleCriterion\"][\"key\"] === \"undefined\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"ACCOUNT_ID\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"S3_BUCKET_EFFECTIVE_PERMISSION\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"S3_BUCKET_NAME\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"S3_BUCKET_SHARED_ACCESS\") &&\n                                (typeof e[\"simpleCriterion\"][\"values\"] === \"undefined\" ||\n                                    Array.isArray(e[\"simpleCriterion\"][\"values\"]) &&\n                                    e[\"simpleCriterion\"][\"values\"].every((e: any) =>\n                                        typeof e === \"string\"\n                                    ))) &&\n                            (typeof e[\"tagCriterion\"] === \"undefined\" ||\n                                (e[\"tagCriterion\"] !== null &&\n                                    typeof e[\"tagCriterion\"] === \"object\" ||\n                                    typeof e[\"tagCriterion\"] === \"function\") &&\n                                (typeof e[\"tagCriterion\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"GT\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"LT\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"NE\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"tagCriterion\"][\"tagValues\"] === \"undefined\" ||\n                                    Array.isArray(e[\"tagCriterion\"][\"tagValues\"]) &&\n                                    e[\"tagCriterion\"][\"tagValues\"].every((e: any) =>\n                                        (e !== null &&\n                                            typeof e === \"object\" ||\n                                            typeof e === \"function\") &&\n                                        (typeof e[\"key\"] === \"undefined\" ||\n                                            typeof e[\"key\"] === \"string\") &&\n                                        (typeof e[\"value\"] === \"undefined\" ||\n                                            typeof e[\"value\"] === \"string\")\n                                    )))\n                        ))) &&\n                (typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"] === \"undefined\" ||\n                    (typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"] !== null &&\n                        typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"] === \"object\" ||\n                        typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"] === \"function\") &&\n                    (typeof typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"][\"and\"] === \"undefined\" ||\n                        Array.isArray(typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"][\"and\"]) &&\n                        typedObj[\"s3JobDefinition\"][\"bucketCriteria\"][\"includes\"][\"and\"].every((e: any) =>\n                            (e !== null &&\n                                typeof e === \"object\" ||\n                                typeof e === \"function\") &&\n                            (typeof e[\"simpleCriterion\"] === \"undefined\" ||\n                                (e[\"simpleCriterion\"] !== null &&\n                                    typeof e[\"simpleCriterion\"] === \"object\" ||\n                                    typeof e[\"simpleCriterion\"] === \"function\") &&\n                                (typeof e[\"simpleCriterion\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"GT\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"LT\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"NE\" ||\n                                    e[\"simpleCriterion\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"simpleCriterion\"][\"key\"] === \"undefined\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"ACCOUNT_ID\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"S3_BUCKET_EFFECTIVE_PERMISSION\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"S3_BUCKET_NAME\" ||\n                                    e[\"simpleCriterion\"][\"key\"] === \"S3_BUCKET_SHARED_ACCESS\") &&\n                                (typeof e[\"simpleCriterion\"][\"values\"] === \"undefined\" ||\n                                    Array.isArray(e[\"simpleCriterion\"][\"values\"]) &&\n                                    e[\"simpleCriterion\"][\"values\"].every((e: any) =>\n                                        typeof e === \"string\"\n                                    ))) &&\n                            (typeof e[\"tagCriterion\"] === \"undefined\" ||\n                                (e[\"tagCriterion\"] !== null &&\n                                    typeof e[\"tagCriterion\"] === \"object\" ||\n                                    typeof e[\"tagCriterion\"] === \"function\") &&\n                                (typeof e[\"tagCriterion\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"GT\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"LT\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"NE\" ||\n                                    e[\"tagCriterion\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"tagCriterion\"][\"tagValues\"] === \"undefined\" ||\n                                    Array.isArray(e[\"tagCriterion\"][\"tagValues\"]) &&\n                                    e[\"tagCriterion\"][\"tagValues\"].every((e: any) =>\n                                        (e !== null &&\n                                            typeof e === \"object\" ||\n                                            typeof e === \"function\") &&\n                                        (typeof e[\"key\"] === \"undefined\" ||\n                                            typeof e[\"key\"] === \"string\") &&\n                                        (typeof e[\"value\"] === \"undefined\" ||\n                                            typeof e[\"value\"] === \"string\")\n                                    )))\n                        )))) &&\n            (typeof typedObj[\"s3JobDefinition\"][\"bucketDefinitions\"] === \"undefined\" ||\n                Array.isArray(typedObj[\"s3JobDefinition\"][\"bucketDefinitions\"]) &&\n                typedObj[\"s3JobDefinition\"][\"bucketDefinitions\"].every((e: any) =>\n                    (e !== null &&\n                        typeof e === \"object\" ||\n                        typeof e === \"function\") &&\n                    (typeof e[\"accountId\"] === \"undefined\" ||\n                        typeof e[\"accountId\"] === \"string\") &&\n                    (typeof e[\"buckets\"] === \"undefined\" ||\n                        Array.isArray(e[\"buckets\"]) &&\n                        e[\"buckets\"].every((e: any) =>\n                            typeof e === \"string\"\n                        ))\n                )) &&\n            (typeof typedObj[\"s3JobDefinition\"][\"scoping\"] === \"undefined\" ||\n                (typedObj[\"s3JobDefinition\"][\"scoping\"] !== null &&\n                    typeof typedObj[\"s3JobDefinition\"][\"scoping\"] === \"object\" ||\n                    typeof typedObj[\"s3JobDefinition\"][\"scoping\"] === \"function\") &&\n                (typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"] === \"undefined\" ||\n                    (typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"] !== null &&\n                        typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"] === \"object\" ||\n                        typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"] === \"function\") &&\n                    (typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"][\"and\"] === \"undefined\" ||\n                        Array.isArray(typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"][\"and\"]) &&\n                        typedObj[\"s3JobDefinition\"][\"scoping\"][\"excludes\"][\"and\"].every((e: any) =>\n                            (e !== null &&\n                                typeof e === \"object\" ||\n                                typeof e === \"function\") &&\n                            (typeof e[\"simpleScopeTerm\"] === \"undefined\" ||\n                                (e[\"simpleScopeTerm\"] !== null &&\n                                    typeof e[\"simpleScopeTerm\"] === \"object\" ||\n                                    typeof e[\"simpleScopeTerm\"] === \"function\") &&\n                                (typeof e[\"simpleScopeTerm\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"GT\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"LT\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"NE\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"simpleScopeTerm\"][\"key\"] === \"undefined\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_EXTENSION\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_KEY\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_LAST_MODIFIED_DATE\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_SIZE\") &&\n                                (typeof e[\"simpleScopeTerm\"][\"values\"] === \"undefined\" ||\n                                    Array.isArray(e[\"simpleScopeTerm\"][\"values\"]) &&\n                                    e[\"simpleScopeTerm\"][\"values\"].every((e: any) =>\n                                        typeof e === \"string\"\n                                    ))) &&\n                            (typeof e[\"tagScopeTerm\"] === \"undefined\" ||\n                                (e[\"tagScopeTerm\"] !== null &&\n                                    typeof e[\"tagScopeTerm\"] === \"object\" ||\n                                    typeof e[\"tagScopeTerm\"] === \"function\") &&\n                                (typeof e[\"tagScopeTerm\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"GT\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"LT\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"NE\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"tagScopeTerm\"][\"key\"] === \"undefined\" ||\n                                    typeof e[\"tagScopeTerm\"][\"key\"] === \"string\") &&\n                                (typeof e[\"tagScopeTerm\"][\"tagValues\"] === \"undefined\" ||\n                                    Array.isArray(e[\"tagScopeTerm\"][\"tagValues\"]) &&\n                                    e[\"tagScopeTerm\"][\"tagValues\"].every((e: any) =>\n                                        (e !== null &&\n                                            typeof e === \"object\" ||\n                                            typeof e === \"function\") &&\n                                        (typeof e[\"key\"] === \"undefined\" ||\n                                            typeof e[\"key\"] === \"string\") &&\n                                        (typeof e[\"value\"] === \"undefined\" ||\n                                            typeof e[\"value\"] === \"string\")\n                                    )) &&\n                                (typeof e[\"tagScopeTerm\"][\"target\"] === \"undefined\" ||\n                                    e[\"tagScopeTerm\"][\"target\"] === \"S3_OBJECT\"))\n                        ))) &&\n                (typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"] === \"undefined\" ||\n                    (typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"] !== null &&\n                        typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"] === \"object\" ||\n                        typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"] === \"function\") &&\n                    (typeof typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"][\"and\"] === \"undefined\" ||\n                        Array.isArray(typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"][\"and\"]) &&\n                        typedObj[\"s3JobDefinition\"][\"scoping\"][\"includes\"][\"and\"].every((e: any) =>\n                            (e !== null &&\n                                typeof e === \"object\" ||\n                                typeof e === \"function\") &&\n                            (typeof e[\"simpleScopeTerm\"] === \"undefined\" ||\n                                (e[\"simpleScopeTerm\"] !== null &&\n                                    typeof e[\"simpleScopeTerm\"] === \"object\" ||\n                                    typeof e[\"simpleScopeTerm\"] === \"function\") &&\n                                (typeof e[\"simpleScopeTerm\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"GT\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"LT\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"NE\" ||\n                                    e[\"simpleScopeTerm\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"simpleScopeTerm\"][\"key\"] === \"undefined\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_EXTENSION\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_KEY\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_LAST_MODIFIED_DATE\" ||\n                                    e[\"simpleScopeTerm\"][\"key\"] === \"OBJECT_SIZE\") &&\n                                (typeof e[\"simpleScopeTerm\"][\"values\"] === \"undefined\" ||\n                                    Array.isArray(e[\"simpleScopeTerm\"][\"values\"]) &&\n                                    e[\"simpleScopeTerm\"][\"values\"].every((e: any) =>\n                                        typeof e === \"string\"\n                                    ))) &&\n                            (typeof e[\"tagScopeTerm\"] === \"undefined\" ||\n                                (e[\"tagScopeTerm\"] !== null &&\n                                    typeof e[\"tagScopeTerm\"] === \"object\" ||\n                                    typeof e[\"tagScopeTerm\"] === \"function\") &&\n                                (typeof e[\"tagScopeTerm\"][\"comparator\"] === \"undefined\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"CONTAINS\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"EQ\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"GT\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"GTE\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"LT\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"LTE\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"NE\" ||\n                                    e[\"tagScopeTerm\"][\"comparator\"] === \"STARTS_WITH\") &&\n                                (typeof e[\"tagScopeTerm\"][\"key\"] === \"undefined\" ||\n                                    typeof e[\"tagScopeTerm\"][\"key\"] === \"string\") &&\n                                (typeof e[\"tagScopeTerm\"][\"tagValues\"] === \"undefined\" ||\n                                    Array.isArray(e[\"tagScopeTerm\"][\"tagValues\"]) &&\n                                    e[\"tagScopeTerm\"][\"tagValues\"].every((e: any) =>\n                                        (e !== null &&\n                                            typeof e === \"object\" ||\n                                            typeof e === \"function\") &&\n                                        (typeof e[\"key\"] === \"undefined\" ||\n                                            typeof e[\"key\"] === \"string\") &&\n                                        (typeof e[\"value\"] === \"undefined\" ||\n                                            typeof e[\"value\"] === \"string\")\n                                    )) &&\n                                (typeof e[\"tagScopeTerm\"][\"target\"] === \"undefined\" ||\n                                    e[\"tagScopeTerm\"][\"target\"] === \"S3_OBJECT\"))\n                        ))))) &&\n        (typeof typedObj[\"samplingPercentage\"] === \"undefined\" ||\n            typeof typedObj[\"samplingPercentage\"] === \"number\") &&\n        (typeof typedObj[\"scheduleFrequency\"] === \"undefined\" ||\n            (typedObj[\"scheduleFrequency\"] !== null &&\n                typeof typedObj[\"scheduleFrequency\"] === \"object\" ||\n                typeof typedObj[\"scheduleFrequency\"] === \"function\") &&\n            (typeof typedObj[\"scheduleFrequency\"][\"dailySchedule\"] === \"undefined\" ||\n                (typedObj[\"scheduleFrequency\"][\"dailySchedule\"] !== null &&\n                    typeof typedObj[\"scheduleFrequency\"][\"dailySchedule\"] === \"object\" ||\n                    typeof typedObj[\"scheduleFrequency\"][\"dailySchedule\"] === \"function\")) &&\n            (typeof typedObj[\"scheduleFrequency\"][\"monthlySchedule\"] === \"undefined\" ||\n                (typedObj[\"scheduleFrequency\"][\"monthlySchedule\"] !== null &&\n                    typeof typedObj[\"scheduleFrequency\"][\"monthlySchedule\"] === \"object\" ||\n                    typeof typedObj[\"scheduleFrequency\"][\"monthlySchedule\"] === \"function\") &&\n                (typeof typedObj[\"scheduleFrequency\"][\"monthlySchedule\"][\"dayOfMonth\"] === \"undefined\" ||\n                    typeof typedObj[\"scheduleFrequency\"][\"monthlySchedule\"][\"dayOfMonth\"] === \"number\")) &&\n            (typeof typedObj[\"scheduleFrequency\"][\"weeklySchedule\"] === \"undefined\" ||\n                (typedObj[\"scheduleFrequency\"][\"weeklySchedule\"] !== null &&\n                    typeof typedObj[\"scheduleFrequency\"][\"weeklySchedule\"] === \"object\" ||\n                    typeof typedObj[\"scheduleFrequency\"][\"weeklySchedule\"] === \"function\") &&\n                (typeof typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"undefined\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"FRIDAY\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"MONDAY\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"SATURDAY\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"SUNDAY\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"THURSDAY\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"TUESDAY\" ||\n                    typedObj[\"scheduleFrequency\"][\"weeklySchedule\"][\"dayOfWeek\"] === \"WEDNESDAY\"))) &&\n        (typeof typedObj[\"tags\"] === \"undefined\" ||\n            (typedObj[\"tags\"] !== null &&\n                typeof typedObj[\"tags\"] === \"object\" ||\n                typeof typedObj[\"tags\"] === \"function\") &&\n            Object.entries<any>(typedObj[\"tags\"])\n                .every(([key, value]) => (typeof value === \"string\" &&\n                    typeof key === \"string\")))\n    )\n}\n\nexport function isMacieJobSuccessResponse(obj: unknown): obj is MacieJobSuccessResponse {\n    const typedObj = obj as MacieJobSuccessResponse\n    return (\n        (typedObj !== null &&\n            typeof typedObj === \"object\" ||\n            typeof typedObj === \"function\") &&\n        typedObj[\"success\"] === true &&\n        (typedObj[\"data\"] !== null &&\n            typeof typedObj[\"data\"] === \"object\" ||\n            typeof typedObj[\"data\"] === \"function\") &&\n        typeof typedObj[\"data\"][\"jobId\"] === \"string\" &&\n        typeof typedObj[\"data\"][\"jobArn\"] === \"string\" &&\n        typeof typedObj[\"data\"][\"requestId\"] === \"string\"\n    )\n}\n\nexport function isMacieJobErrorResponse(obj: unknown): obj is MacieJobErrorResponse {\n    const typedObj = obj as MacieJobErrorResponse\n    return (\n        (typedObj !== null &&\n            typeof typedObj === \"object\" ||\n            typeof typedObj === \"function\") &&\n        typedObj[\"success\"] === false &&\n        (typedObj[\"error\"] !== null &&\n            typeof typedObj[\"error\"] === \"object\" ||\n            typeof typedObj[\"error\"] === \"function\") &&\n        typeof typedObj[\"error\"][\"type\"] === \"string\" &&\n        typeof typedObj[\"error\"][\"message\"] === \"string\" &&\n        typeof typedObj[\"error\"][\"requestId\"] === \"string\"\n    )\n}\n\nexport function isMacieJobResponse(obj: unknown): obj is MacieJobResponse {\n    const typedObj = obj as MacieJobResponse\n    return (\n        (isMacieJobSuccessResponse(typedObj) as boolean ||\n            isMacieJobErrorResponse(typedObj) as boolean)\n    )\n}\n", "/**\n * Logger utility for detailed parameter logging in Lambda functions\n */\n\nexport interface LogContext {\n  requestId: string;\n  functionName?: string;\n  functionVersion?: string;\n}\n\nexport class Logger {\n  private context: LogContext;\n\n  constructor(context: LogContext) {\n    this.context = context;\n  }\n\n  /**\n   * Log info level messages with detailed context\n   */\n  info(message: string, data?: any): void {\n    const logEntry = {\n      level: 'INFO',\n      timestamp: new Date().toISOString(),\n      requestId: this.context.requestId,\n      functionName: this.context.functionName,\n      functionVersion: this.context.functionVersion,\n      message,\n      data: data ? this.sanitizeData(data) : undefined\n    };\n    \n    console.log(JSON.stringify(logEntry));\n  }\n\n  /**\n   * Log error level messages with detailed context\n   */\n  error(message: string, error?: Error | any, data?: any): void {\n    const logEntry = {\n      level: 'ERROR',\n      timestamp: new Date().toISOString(),\n      requestId: this.context.requestId,\n      functionName: this.context.functionName,\n      functionVersion: this.context.functionVersion,\n      message,\n      error: error ? {\n        name: error.name,\n        message: error.message,\n        stack: error.stack,\n        ...error\n      } : undefined,\n      data: data ? this.sanitizeData(data) : undefined\n    };\n    \n    console.error(JSON.stringify(logEntry));\n  }\n\n  /**\n   * Log debug level messages with detailed context\n   */\n  debug(message: string, data?: any): void {\n    const logEntry = {\n      level: 'DEBUG',\n      timestamp: new Date().toISOString(),\n      requestId: this.context.requestId,\n      functionName: this.context.functionName,\n      functionVersion: this.context.functionVersion,\n      message,\n      data: data ? this.sanitizeData(data) : undefined\n    };\n    \n    console.log(JSON.stringify(logEntry));\n  }\n\n  /**\n   * Log API request details\n   */\n  logApiRequest(service: string, operation: string, parameters: any): void {\n    this.info(`${service} API Request: ${operation}`, {\n      service,\n      operation,\n      parameters: this.sanitizeData(parameters)\n    });\n  }\n\n  /**\n   * Log API response details\n   */\n  logApiResponse(service: string, operation: string, response: any, duration?: number): void {\n    this.info(`${service} API Response: ${operation}`, {\n      service,\n      operation,\n      duration: duration ? `${duration}ms` : undefined,\n      response: this.sanitizeData(response)\n    });\n  }\n\n  /**\n   * Log execution timing\n   */\n  logTiming(operation: string, startTime: number): void {\n    const duration = Date.now() - startTime;\n    this.info(`Operation completed: ${operation}`, {\n      operation,\n      duration: `${duration}ms`\n    });\n  }\n\n  /**\n   * Sanitize sensitive data for logging\n   * Remove or mask sensitive information\n   */\n  private sanitizeData(data: any): any {\n    if (!data) return data;\n    \n    // Create a deep copy to avoid modifying the original\n    const sanitized = JSON.parse(JSON.stringify(data));\n    \n    // List of sensitive keys to mask\n    const sensitiveKeys = [\n      'password',\n      'secret',\n      'token',\n      'key',\n      'authorization',\n      'auth',\n      'credential',\n      'clientToken'\n    ];\n    \n    return this.maskSensitiveFields(sanitized, sensitiveKeys);\n  }\n\n  /**\n   * Recursively mask sensitive fields in an object\n   */\n  private maskSensitiveFields(obj: any, sensitiveKeys: string[]): any {\n    if (typeof obj !== 'object' || obj === null) {\n      return obj;\n    }\n\n    if (Array.isArray(obj)) {\n      return obj.map(item => this.maskSensitiveFields(item, sensitiveKeys));\n    }\n\n    const result: any = {};\n    for (const [key, value] of Object.entries(obj)) {\n      const lowerKey = key.toLowerCase();\n      const isSensitive = sensitiveKeys.some(sensitiveKey => \n        lowerKey.includes(sensitiveKey.toLowerCase())\n      );\n\n      if (isSensitive && typeof value === 'string') {\n        result[key] = '***MASKED***';\n      } else if (typeof value === 'object') {\n        result[key] = this.maskSensitiveFields(value, sensitiveKeys);\n      } else {\n        result[key] = value;\n      }\n    }\n\n    return result;\n  }\n}\n", "import { Context } from 'aws-lambda';\nimport { Logger } from './logger';\n\n/**\n * Common error handling utilities for Lambda functions\n */\n\nexport interface ErrorDetails {\n  name?: string;\n  message: string;\n  stack?: string;\n  statusCode?: number;\n  requestId?: string;\n  [key: string]: any;\n}\n\nexport interface StandardErrorResponse {\n  success: false;\n  error: {\n    type: string;\n    message: string;\n    details?: any;\n    requestId: string;\n  };\n}\n\nexport class ErrorHandler {\n  private logger: Logger;\n  private context: Context;\n\n  constructor(logger: Logger, context: Context) {\n    this.logger = logger;\n    this.context = context;\n  }\n\n  /**\n   * Handle validation errors\n   */\n  handleValidationError(message: string, receivedData?: any): StandardErrorResponse {\n    this.logger.error('Validation Error', undefined, { receivedData });\n    \n    return {\n      success: false,\n      error: {\n        type: 'ValidationError',\n        message,\n        details: 'The provided input does not conform to the expected schema',\n        requestId: this.context.awsRequestId\n      }\n    };\n  }\n\n  /**\n   * Handle AWS API errors\n   */\n  handleAwsApiError(error: any, service: string, operation: string): StandardErrorResponse {\n    this.logger.error(`${service} API Error`, error, {\n      service,\n      operation,\n      errorCode: error.name,\n      statusCode: error.$metadata?.httpStatusCode,\n      awsRequestId: error.$metadata?.requestId\n    });\n\n    return {\n      success: false,\n      error: {\n        type: error.name || `${service}ApiError`,\n        message: error.message || `Failed to execute ${service} ${operation}`,\n        details: {\n          errorCode: error.name,\n          statusCode: error.$metadata?.httpStatusCode,\n          awsRequestId: error.$metadata?.requestId\n        },\n        requestId: this.context.awsRequestId\n      }\n    };\n  }\n\n  /**\n   * Handle unexpected errors\n   */\n  handleUnexpectedError(error: any): StandardErrorResponse {\n    this.logger.error('Unexpected Error', error);\n    \n    return {\n      success: false,\n      error: {\n        type: 'UnexpectedError',\n        message: error.message || 'An unexpected error occurred',\n        details: {\n          name: error.name,\n          stack: error.stack\n        },\n        requestId: this.context.awsRequestId\n      }\n    };\n  }\n\n  /**\n   * Handle custom application errors\n   */\n  handleCustomError(type: string, message: string, details?: any): StandardErrorResponse {\n    this.logger.error(`Custom Error: ${type}`, undefined, { details });\n    \n    return {\n      success: false,\n      error: {\n        type,\n        message,\n        details,\n        requestId: this.context.awsRequestId\n      }\n    };\n  }\n\n  /**\n   * Handle EventBridge validation errors\n   */\n  handleEventBridgeValidationError(message: string, eventBusArn?: string, validationError?: string): StandardErrorResponse {\n    this.logger.error('EventBridge Validation Error', undefined, { \n      eventBusArn,\n      validationError \n    });\n    \n    return {\n      success: false,\n      error: {\n        type: 'EventBridgeValidationError',\n        message,\n        details: {\n          eventBusArn,\n          validationError,\n          requiredTagKey: 'JobStatusEventBusArn',\n          expectedArnFormat: 'arn:aws:events:region:account:event-bus/name'\n        },\n        requestId: this.context.awsRequestId\n      }\n    };\n  }\n\n  /**\n   * Determine error type and handle appropriately\n   */\n  handleError(error: any, context?: { service?: string; operation?: string }): StandardErrorResponse {\n    // AWS SDK errors\n    if (error.$metadata) {\n      return this.handleAwsApiError(error, context?.service || 'AWS', context?.operation || 'Unknown');\n    }\n\n    // Custom application errors\n    if (error.type && error.message) {\n      return this.handleCustomError(error.type, error.message, error.details);\n    }\n\n    // Default to unexpected error\n    return this.handleUnexpectedError(error);\n  }\n}\n", "import { EventBridgeClient, DescribeEventBusCommand } from '@aws-sdk/client-eventbridge';\nimport { Logger } from './logger';\n\n/**\n * EventBridge validation utilities\n */\n\nexport interface EventBusValidationResult {\n  isValid: boolean;\n  eventBusName?: string;\n  error?: string;\n}\n\nexport class EventBridgeValidator {\n  private client: EventBridgeClient;\n  private logger: Logger;\n\n  constructor(logger: Logger, region?: string) {\n    this.logger = logger;\n    this.client = new EventBridgeClient({\n      region: region || process.env.AWS_REGION || 'us-east-1'\n    });\n  }\n\n  /**\n   * Validate EventBridge ARN format\n   */\n  validateEventBusArnFormat(arn: string): boolean {\n    const eventBusArnPattern = /^arn:aws:events:[a-z0-9-]+:\\d{12}:event-bus\\/[a-zA-Z0-9._-]+$/;\n    return eventBusArnPattern.test(arn);\n  }\n\n  /**\n   * Extract event bus name from ARN\n   */\n  extractEventBusNameFromArn(arn: string): string | null {\n    const match = arn.match(/^arn:aws:events:[a-z0-9-]+:\\d{12}:event-bus\\/(.+)$/);\n    return match ? match[1] : null;\n  }\n\n  /**\n   * Check if EventBus exists by calling AWS API\n   */\n  async validateEventBusExists(eventBusName: string): Promise<EventBusValidationResult> {\n    try {\n      this.logger.info('Validating EventBus existence', { eventBusName });\n      \n      const command = new DescribeEventBusCommand({\n        Name: eventBusName\n      });\n\n      const response = await this.client.send(command);\n      \n      if (response.Name) {\n        this.logger.info('EventBus validation successful', { \n          eventBusName: response.Name,\n          eventBusArn: response.Arn \n        });\n        \n        return {\n          isValid: true,\n          eventBusName: response.Name\n        };\n      } else {\n        return {\n          isValid: false,\n          error: 'EventBus response missing name'\n        };\n      }\n    } catch (error: any) {\n      this.logger.error('EventBus validation failed', error, { eventBusName });\n      \n      return {\n        isValid: false,\n        error: error.message || 'Failed to validate EventBus'\n      };\n    }\n  }\n\n  /**\n   * Find EventBus ARN tag (case-insensitive)\n   */\n  findEventBusArnTag(tags: Record<string, string> | undefined): string | null {\n    if (!tags) {\n      return null;\n    }\n\n    // Search for the tag key case-insensitively\n    const targetKey = 'jobstatuseventbusarn';\n    \n    for (const [key, value] of Object.entries(tags)) {\n      if (key.toLowerCase() === targetKey) {\n        return value;\n      }\n    }\n    \n    return null;\n  }\n\n  /**\n   * Complete validation: format + existence check\n   */\n  async validateEventBusArn(arn: string): Promise<EventBusValidationResult> {\n    // Step 1: Validate ARN format\n    if (!this.validateEventBusArnFormat(arn)) {\n      return {\n        isValid: false,\n        error: 'Invalid EventBridge ARN format. Expected: arn:aws:events:region:account:event-bus/name'\n      };\n    }\n\n    // Step 2: Extract event bus name\n    const eventBusName = this.extractEventBusNameFromArn(arn);\n    if (!eventBusName) {\n      return {\n        isValid: false,\n        error: 'Could not extract EventBus name from ARN'\n      };\n    }\n\n    // Step 3: Check if EventBus exists\n    return await this.validateEventBusExists(eventBusName);\n  }\n}\n"],
  "mappings": "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",
  "names": ["index_exports", "__export", "handler", "__toCommonJS", "import_client_macie2", "isMacieJobRequest", "obj", "typedObj", "e", "key", "value", "__name", "Logger", "__name", "context", "message", "data", "logEntry", "error", "service", "operation", "parameters", "response", "duration", "startTime", "sanitized", "sensitiveKeys", "obj", "item", "result", "key", "value", "lowerKey", "sensitiveKey", "ErrorHandler", "__name", "logger", "context", "message", "receivedData", "error", "service", "operation", "type", "details", "eventBusArn", "validationError", "import_client_eventbridge", "EventBridgeValidator", "__name", "logger", "region", "arn", "match", "eventBusName", "command", "response", "error", "tags", "targetKey", "key", "value", "isAPIGatewayEvent", "event", "__name", "createAPIGatewayErrorResponse", "statusCode", "message", "requestId", "createAPIGatewaySuccessResponse", "data", "handler", "context", "startTime", "logger", "Logger", "errorHandler", "ErrorHandler", "macieJobRequest", "parseError", "errorMessage", "isMacieJobRequest", "eventBridgeValidator", "EventBridgeValidator", "eventBusArn", "providedTags", "errorResponse", "validationResult", "macieClient", "createJobCommand", "apiStartTime", "response", "macieError", "apiDuration", "successResponse", "error"]
}
