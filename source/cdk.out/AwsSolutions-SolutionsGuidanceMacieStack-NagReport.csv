Rule ID,Resource ID,Compliance,Exception Reason,Rule Level,Rule Info
"AwsSolutions-IAM4","SolutionsGuidanceMacieStack/CreateMacieJobFunction/ServiceRole/Resource","Suppressed","Lambda function uses AWS managed policy AWSLambdaBasicExecutionRole for CloudWatch Logs access, which is a standard practice.","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/CreateMacieJobFunction/ServiceRole/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/CreateMacieJobFunction/ServiceRole/DefaultPolicy/Resource","Suppressed","Macie requires broad permissions to access S3 buckets and create classification jobs. The specific resources are determined at runtime based on the job configuration.","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-L1","SolutionsGuidanceMacieStack/CreateMacieJobFunction/Resource","Suppressed","Using NODEJS_LATEST runtime to ensure compatibility with latest AWS SDK versions and security patches.","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-IAM4","SolutionsGuidanceMacieStack/ProcessMacieJobStatusFunction/ServiceRole/Resource","Suppressed","Lambda function uses AWS managed policy AWSLambdaBasicExecutionRole for CloudWatch Logs access, which is a standard practice.","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/ProcessMacieJobStatusFunction/ServiceRole/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/ProcessMacieJobStatusFunction/ServiceRole/DefaultPolicy/Resource","Suppressed","Function needs broad permissions to access Macie jobs and EventBridge event buses determined at runtime from job configurations.","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-L1","SolutionsGuidanceMacieStack/ProcessMacieJobStatusFunction/Resource","Suppressed","Using NODEJS_LATEST runtime to ensure compatibility with latest AWS SDK versions and security patches.","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-IAM4","SolutionsGuidanceMacieStack/GetMacieFindingsFunction/ServiceRole/Resource","Suppressed","Lambda function uses AWS managed policy AWSLambdaBasicExecutionRole for CloudWatch Logs access, which is a standard practice.","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/GetMacieFindingsFunction/ServiceRole/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/GetMacieFindingsFunction/ServiceRole/DefaultPolicy/Resource","Suppressed","Function needs broad permissions to access Macie findings which are queried by job ID at runtime.","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
"AwsSolutions-L1","SolutionsGuidanceMacieStack/GetMacieFindingsFunction/Resource","Suppressed","Using NODEJS_LATEST runtime to ensure compatibility with latest AWS SDK versions and security patches.","Error","The non-container Lambda function is not configured to use the latest runtime version."
"AwsSolutions-APIG2","SolutionsGuidanceMacieStack/MacieApi/Resource","Compliant","N/A","Error","The REST API does not have request validation enabled."
"AwsSolutions-APIG1","SolutionsGuidanceMacieStack/MacieApi/DeploymentStage.v1/Resource","Compliant","N/A","Error","The API does not have access logging enabled."
"AwsSolutions-APIG3","SolutionsGuidanceMacieStack/MacieApi/DeploymentStage.v1/Resource","Compliant","N/A","Warning","The REST API stage is not associated with AWS WAFv2 web ACL."
"AwsSolutions-APIG6","SolutionsGuidanceMacieStack/MacieApi/DeploymentStage.v1/Resource","Suppressed","CloudWatch logging is enabled for the API Gateway stage with INFO level logging and access logs.","Error","The REST API Stage does not have CloudWatch logging enabled for all methods."
"AwsSolutions-APIG4","SolutionsGuidanceMacieStack/MacieApi/Default/create-job/POST/Resource","Compliant","N/A","Error","The API does not implement authorization."
"AwsSolutions-COG4","SolutionsGuidanceMacieStack/MacieApi/Default/create-job/POST/Resource","Suppressed","IAM authentication is used instead of Cognito for this internal API, which is appropriate for service-to-service communication.","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-APIG4","SolutionsGuidanceMacieStack/MacieApi/Default/get-findings/GET/Resource","Compliant","N/A","Error","The API does not implement authorization."
"AwsSolutions-COG4","SolutionsGuidanceMacieStack/MacieApi/Default/get-findings/GET/Resource","Suppressed","IAM authentication is used instead of Cognito for this internal API, which is appropriate for service-to-service communication.","Error","The API GW method does not use a Cognito user pool authorizer."
"AwsSolutions-IAM4","SolutionsGuidanceMacieStack/ApiGatewayCloudWatchRole/Resource","Suppressed","API Gateway CloudWatch role uses AWS managed policy AmazonAPIGatewayPushToCloudWatchLogs which is the standard AWS-recommended policy for this purpose.","Error","The IAM user, role, or group uses AWS managed policies."
"AwsSolutions-IAM5","SolutionsGuidanceMacieStack/ApiGatewayCloudWatchRole/Resource","Compliant","N/A","Error","The IAM entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission."
